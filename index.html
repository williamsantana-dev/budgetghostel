<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Or√ßamento - Pousada</title>
<style>
/* Clean Banking Login Form - Complete & Self-Contained */

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    min-height: 100vh;
    padding: 20px;
    line-height: 1.6;
}

.login-container {
    width: 100%;
    max-width: 800px;
}

.card {
    background: #ffffff;
    border-radius: 16px;
    padding: 32px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    border: 1px solid #f1f5f9;
    margin-bottom: 24px;
}

.header {
    text-align: center;
    margin-bottom: 32px;
}

.logo {
    margin-bottom: 16px;
    display: flex;
    justify-content: center;
}

.header h1 {
    color: #1e293b;
    font-size: 1.75rem;
    font-weight: 700;
    margin-bottom: 6px;
    letter-spacing: -0.025em;
}

.header p {
    color: #64748b;
    font-size: 14px;
    font-weight: 500;
}

/* Form Styles */
.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
}

.form-group {
    margin-bottom: 20px;
    position: relative;
}

.form-group.full-width {
    grid-column: span 2;
}

.form-group label {
    display: block;
    font-size: 13px;
    font-weight: 600;
    color: #374151;
    margin-bottom: 6px;
}

.form-group input, .form-group select {
    width: 100%;
    background: #ffffff;
    border: 1.5px solid #e2e8f0;
    border-radius: 8px;
    padding: 12px 14px;
    color: #1e293b;
    font-size: 16px;
    font-weight: 400;
    outline: none;
    transition: all 0.2s ease;
    font-family: inherit;
}

.form-group input:focus, .form-group select:focus {
    border-color: #6366F1;
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

.form-group input::placeholder {
    color: #94a3b8;
}

/* Checkbox Styles */
.checkbox-wrapper {
    display: flex;
    align-items: center;
    cursor: pointer;
    font-size: 14px;
    color: #374151;
    font-weight: 500;
    margin-bottom: 12px;
}

.checkbox-wrapper input[type="checkbox"] {
    display: none;
}

.checkmark {
    width: 18px;
    height: 18px;
    border: 1.5px solid #d1d5db;
    border-radius: 4px;
    margin-right: 12px;
    position: relative;
    transition: all 0.2s ease;
    background: #ffffff;
    flex-shrink: 0;
}

.checkbox-wrapper input[type="checkbox"]:checked + .checkmark {
    background: #6366F1;
    border-color: #6366F1;
}

.checkmark::after {
    content: '';
    position: absolute;
    left: 5px;
    top: 2px;
    width: 3px;
    height: 7px;
    border: solid white;
    border-width: 0 1.5px 1.5px 0;
    transform: rotate(45deg);
    opacity: 0;
    transition: opacity 0.2s ease;
}

.checkbox-wrapper input[type="checkbox"]:checked + .checkmark::after {
    opacity: 1;
}

/* Conditional Fields */
.conditional-field {
    margin-left: 30px;
    margin-top: 12px;
    opacity: 0.6;
    transition: opacity 0.2s ease;
}

.conditional-field.active {
    opacity: 1;
}

.conditional-field input {
    font-size: 15px;
}

/* Button Styles */
.btn {
    background: #6366F1;
    color: #ffffff;
    border: none;
    border-radius: 8px;
    padding: 12px 24px;
    cursor: pointer;
    font-family: inherit;
    font-size: 15px;
    font-weight: 600;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.btn:hover {
    background: #4f46e5;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
}

.btn:active {
    transform: translateY(0);
}

.btn.btn-secondary {
    background: #64748b;
}

.btn.btn-secondary:hover {
    background: #475569;
}

.btn-group {
    display: flex;
    gap: 12px;
    justify-content: center;
    margin-top: 24px;
}

/* Result Section */
.result-section {
    display: none;
}

.result-section.show {
    display: block;
}

.markdown-output {
    background: #f8fafc;
    border: 1.5px solid #e2e8f0;
    border-radius: 8px;
    padding: 20px;
    font-family: 'Courier New', monospace;
    font-size: 14px;
    line-height: 1.6;
    white-space: pre-wrap;
    color: #1e293b;
    margin-bottom: 16px;
    min-height: 200px;
}

.copy-btn {
    width: 100%;
    background: #10b981;
}

.copy-btn:hover {
    background: #059669;
}

.copy-success {
    background: #10b981;
    color: white;
    padding: 8px 16px;
    border-radius: 6px;
    font-size: 14px;
    text-align: center;
    margin-top: 12px;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.copy-success.show {
    opacity: 1;
}

/* Info Box */
.info-box {
    background: #eff6ff;
    border: 1px solid #bfdbfe;
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 20px;
}

.info-box h3 {
    color: #1e40af;
    font-size: 14px;
    font-weight: 600;
    margin-bottom: 8px;
}

.info-box p {
    color: #1e40af;
    font-size: 13px;
    line-height: 1.5;
}

/* Room availability indicator */
.room-indicator {
    font-size: 12px;
    color: #64748b;
    margin-left: 8px;
}

.room-indicator.available {
    color: #10b981;
}

.room-indicator.limited {
    color: #f59e0b;
}

.room-indicator.unavailable {
    color: #ef4444;
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .container {
        padding: 0 16px;
    }
    
    .card {
        padding: 24px 20px;
        border-radius: 12px;
    }
    
    .header h1 {
        font-size: 1.5rem;
    }
    
    .form-row {
        grid-template-columns: 1fr;
        gap: 16px;
    }
    
    .form-group.full-width {
        grid-column: span 1;
    }
    
    .btn-group {
        flex-direction: column;
    }
    
    .conditional-field {
        margin-left: 20px;
    }
}

@media (max-width: 480px) {
    body {
        padding: 12px;
    }
    
    .card {
        padding: 20px 16px;
    }
    
    .conditional-field {
        margin-left: 0;
        margin-top: 8px;
        padding-left: 16px;
        border-left: 2px solid #e2e8f0;
    }
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
    body {
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
    }
    
    .card {
        background: #1e293b;
        border-color: #334155;
    }
    
    .header h1 {
        color: #f8fafc;
    }
    
    .header p {
        color: #94a3b8;
    }
    
    .form-group label {
        color: #e2e8f0;
    }
    
    .form-group input, .form-group select {
        background: #334155;
        border-color: #475569;
        color: #f8fafc;
    }
    
    .form-group input::placeholder {
        color: #64748b;
    }
    
    .checkbox-wrapper {
        color: #e2e8f0;
    }
    
    .checkmark {
        border-color: #475569;
        background: #334155;
    }
    
    .markdown-output {
        background: #334155;
        border-color: #475569;
        color: #f8fafc;
    }
    
    .info-box {
        background: #1e40af20;
        border-color: #3b82f6;
    }
    
    .info-box h3 {
        color: #60a5fa;
    }
    
    .info-box p {
        color: #93c5fd;
    }
}
</style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="header">
                <div class="logo">
                    <svg width="36" height="36" viewBox="0 0 36 36" fill="none">
                        <rect width="36" height="36" rx="8" fill="#6366F1"/>
                        <path d="M9 12h18v2H9v-2zm0 4h18v2H9v-2zm0 4h12v2H9v-2zm15-8v12l3-2V10l-3 2z" fill="white"/>
                    </svg>
                </div>
                <h1>Gerador de Or√ßamento</h1>
                <p>Crie or√ßamentos dentro do padr√£o para WhatsApp</p>
            </div>
            
            <form id="budgetForm">
                <div class="info-box">
                    <h3>üìã Instru√ß√µes</h3>
                    <p>Preencha os dados abaixo para gerar um or√ßamento formatado para envio via WhatsApp. O sistema calcular√° automaticamente as di√°rias e sugerir√° os melhores quartos dispon√≠veis.</p>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="checkin">Data de Entrada</label>
                        <input type="date" id="checkin" name="checkin" required>
                    </div>
                    <div class="form-group">
                        <label for="checkout">Data de Sa√≠da</label>
                        <input type="date" id="checkout" name="checkout" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="adults">N√∫mero de Adultos</label>
                        <input type="number" id="adults" name="adults" min="1" max="20" value="2" required>
                    </div>
                    <div class="form-group">
                        <label for="dailyRate">Valor da Di√°ria (R$)</label>
                        <input type="number" id="dailyRate" name="dailyRate" step="0.01" min="0" placeholder="150.00" required>
                    </div>
                </div>

                <div class="form-group">
                    <label class="checkbox-wrapper">
                        <input type="checkbox" id="includeChildren" name="includeChildren">
                        <span class="checkmark"></span>
                        Incluir crian√ßas cortesia
                    </label>
                    <div class="conditional-field" id="childrenField">
                        <label for="children">N√∫mero de Crian√ßas Cortesia</label>
                        <input type="number" id="children" name="children" min="0" max="10" value="0">
                    </div>
                </div>

                <div class="form-group">
                    <label class="checkbox-wrapper">
                        <input type="checkbox" id="includeExtraBed" name="includeExtraBed">
                        <span class="checkmark"></span>
                        Incluir colch√£o extra
                    </label>
                    <div class="conditional-field" id="extraBedField">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="extraBedQuantity">Quantidade de Colch√µes</label>
                                <input type="number" id="extraBedQuantity" name="extraBedQuantity" min="1" max="5" value="1">
                            </div>
                            <div class="form-group">
                                <label for="extraBedPrice">Valor do Colch√£o Extra (R$)</label>
                                <input type="number" id="extraBedPrice" name="extraBedPrice" step="0.01" min="0" placeholder="30.00">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="checkbox-wrapper">
                        <input type="checkbox" id="isAverageRate" name="isAverageRate">
                        <span class="checkmark"></span>
                        Di√°ria √© uma m√©dia?
                    </label>
                </div>

                <div class="form-group">
                    <label for="selectedRoom">Quarto Selecionado</label>
                    <select id="selectedRoom" name="selectedRoom" required>
                        <option value="">Selecione um quarto...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="checkbox-wrapper">
                        <input type="checkbox" id="earlyCheckin" name="earlyCheckin">
                        <span class="checkmark"></span>
                        Early check-in
                    </label>
                    <div class="conditional-field" id="earlyCheckinField">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="earlyHour">Hor√°rio Early Check-in</label>
                                <input type="time" id="earlyHour" name="earlyHour" value="12:00">
                            </div>
                            <div class="form-group">
                                <label for="earlyPrice">Taxa Early Check-in (R$)</label>
                                <input type="number" id="earlyPrice" name="earlyPrice" step="0.01" min="0" placeholder="50.00">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="checkbox-wrapper">
                        <input type="checkbox" id="lateCheckout" name="lateCheckout">
                        <span class="checkmark"></span>
                        Late check-out
                    </label>
                    <div class="conditional-field" id="lateCheckoutField">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="lateHour">Hor√°rio Late Check-out</label>
                                <input type="time" id="lateHour" name="lateHour" value="15:00">
                            </div>
                            <div class="form-group">
                                <label for="latePrice">Taxa Late Check-out (R$)</label>
                                <input type="number" id="latePrice" name="latePrice" step="0.01" min="0" placeholder="50.00">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="btn-group">
                    <button type="button" class="btn" id="generateBtn">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M8 1v14m7-7H1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        Gerar Or√ßamento
                    </button>
                    <button type="button" class="btn btn-secondary" id="clearBtn">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M12 4L4 12m8 0L4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        Limpar
                    </button>
                </div>
            </form>
        </div>

        <div class="card result-section" id="resultSection">
            <h2 style="margin-bottom: 20px; color: #1e293b; font-size: 1.25rem;">üìã Or√ßamento Gerado</h2>
            <div class="markdown-output" id="markdownOutput"></div>
            <button type="button" class="btn copy-btn" id="copyBtn">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <path d="M4 4h8v8H4V4z" stroke="currentColor" stroke-width="1.5" fill="none"/>
                    <path d="M2 2h8v2H2V2zm0 8h2v2H2v-2z" stroke="currentColor" stroke-width="1.5" fill="none"/>
                </svg>
                Copiar para WhatsApp
            </button>
            <div class="copy-success" id="copySuccess">‚úÖ Copiado para a √°rea de transfer√™ncia!</div>
        </div>
    </div>

    <script>
// Gerador de Or√ßamento - Pousada
class BudgetGenerator {
    constructor() {
        this.rooms = [
            { id: 'suite-individual-standard', name: 'Su√≠te individual standard (com ventilador)', capacity: 1, available: 1 },
            { id: 'suite-casal-standard', name: 'Su√≠te casal standard (com ventilador)', capacity: 2, available: 3 },
            { id: 'suite-casal-master', name: 'Su√≠te casal master (com ar condicionado)', capacity: 2, available: 6 },
            { id: 'suite-tripla-master', name: 'Su√≠te tripla master (com ar condicionado)', capacity: 3, available: 2 },
            { id: 'suite-quadrupla-standard', name: 'Su√≠te qu√°drupla standard (com ventilador)', capacity: 4, available: 2 },
            { id: 'suite-quadrupla-master', name: 'Su√≠te qu√°drupla master (com ar condicionado)', capacity: 4, available: 3 },
            { id: 'suite-sextupla-master', name: 'Su√≠te s√™xtupla master (com ar condicionado)', capacity: 6, available: 1 },
            { id: 'suite-coletiva', name: 'Su√≠te coletiva - Separado por sexo (com ar condicionado e sem TV)', capacity: 1, available: 3 }
        ];
        
        this.init();
    }
    
    init() {
        this.bindEvents();
        this.setupConditionalFields();
        this.updateRoomOptions();
        
        // Set default dates
        const today = new Date();
        const tomorrow = new Date(today);
        tomorrow.setDate(tomorrow.getDate() + 1);
        
        document.getElementById('checkin').valueAsDate = today;
        document.getElementById('checkout').valueAsDate = tomorrow;
    }
    
    bindEvents() {
        // Form events
        document.getElementById('generateBtn').addEventListener('click', () => this.generateBudget());
        document.getElementById('clearBtn').addEventListener('click', () => this.clearForm());
        document.getElementById('copyBtn').addEventListener('click', () => this.copyToClipboard());
        
        // Date change events
        document.getElementById('checkin').addEventListener('change', () => this.updateRoomOptions());
        document.getElementById('checkout').addEventListener('change', () => this.updateRoomOptions());
        
        // Adults/children/extra beds change events
        document.getElementById('adults').addEventListener('input', () => this.updateRoomOptions());
        document.getElementById('children').addEventListener('input', () => this.updateRoomOptions());
        document.getElementById('includeChildren').addEventListener('change', () => this.updateRoomOptions());
        document.getElementById('extraBedQuantity').addEventListener('input', () => this.updateRoomOptions());
        document.getElementById('includeExtraBed').addEventListener('change', () => this.updateRoomOptions());
        
        // Daily rate change
        document.getElementById('dailyRate').addEventListener('input', () => this.updateTotal());
        document.getElementById('selectedRoom').addEventListener('change', () => this.updateTotal());
        document.getElementById('extraBedPrice').addEventListener('input', () => this.updateTotal());
        document.getElementById('earlyPrice').addEventListener('input', () => this.updateTotal());
        document.getElementById('latePrice').addEventListener('input', () => this.updateTotal());
    }
    
    setupConditionalFields() {
        const conditionalFields = [
            { checkbox: 'includeChildren', field: 'childrenField' },
            { checkbox: 'includeExtraBed', field: 'extraBedField' },
            { checkbox: 'earlyCheckin', field: 'earlyCheckinField' },
            { checkbox: 'lateCheckout', field: 'lateCheckoutField' }
        ];
        
        conditionalFields.forEach(({ checkbox, field }) => {
            const checkboxEl = document.getElementById(checkbox);
            const fieldEl = document.getElementById(field);
            
            checkboxEl.addEventListener('change', () => {
                fieldEl.classList.toggle('active', checkboxEl.checked);
                if (checkbox === 'includeChildren') {
                    this.updateRoomOptions();
                }
            });
        });
    }
    
    calculateNights() {
        const checkin = new Date(document.getElementById('checkin').value);
        const checkout = new Date(document.getElementById('checkout').value);
        
        if (!checkin || !checkout || checkout <= checkin) {
            return 0;
        }
        
        const diffTime = Math.abs(checkout - checkin);
        return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    }
    
    getTotalPeople() {
        const adults = parseInt(document.getElementById('adults').value) || 0;
        const includeChildren = document.getElementById('includeChildren').checked;
        const children = includeChildren ? (parseInt(document.getElementById('children').value) || 0) : 0;
        
        return adults + children;
    }
    
    updateRoomOptions() {
        const adults = parseInt(document.getElementById('adults').value) || 0;
        const includeChildren = document.getElementById('includeChildren').checked;
        const children = includeChildren ? (parseInt(document.getElementById('children').value) || 0) : 0;
        const includeExtraBed = document.getElementById('includeExtraBed').checked;
        const extraBeds = includeExtraBed ? (parseInt(document.getElementById('extraBedQuantity').value) || 0) : 0;
        
        // For room selection: adults + extra beds (children cortesia are NOT considered for room selection)
        const peopleForRoomSelection = adults + extraBeds;
        const roomSelect = document.getElementById('selectedRoom');
        
        // Clear existing options except the first one
        roomSelect.innerHTML = '<option value="">Selecione um quarto...</option>';
        
        // Logic for room suggestions based on number of people
        let suggestions = [];
        
        if (peopleForRoomSelection <= 6) {
            // Single room suggestions
            suggestions = this.getSingleRoomSuggestions(adults, extraBeds, includeChildren);
        } else {
            // Multiple room combinations for more than 6 people
            suggestions = this.getRoomCombinations(peopleForRoomSelection);
        }
        
        suggestions.forEach(suggestion => {
            const option = document.createElement('option');
            option.value = suggestion.id;
            option.textContent = suggestion.name;
            
            if (suggestion.available === 0) {
                option.disabled = true;
                option.className = 'unavailable';
                option.textContent += ' (Indispon√≠vel)';
            } else if (suggestion.available <= 2) {
                option.className = 'limited';
                option.textContent += ` (${suggestion.available} dispon√≠vel${suggestion.available > 1 ? 'is' : ''})`;
            } else {
                option.className = 'available';
                option.textContent += ` (${suggestion.available} dispon√≠veis)`;
            }
            
            roomSelect.appendChild(option);
        });
        
        this.updateTotal();
    }
    
    getSingleRoomSuggestions(adults, extraBeds, includeChildren) {
        const suggestions = [];
        const totalForRoomSelection = adults + extraBeds; // Children cortesia are NOT considered for room selection
        
        if (totalForRoomSelection === 1) {
            // 1 person: individual or collective
            suggestions.push(
                this.rooms.find(r => r.id === 'suite-individual-standard'),
                this.rooms.find(r => r.id === 'suite-coletiva')
            );
        } else if (totalForRoomSelection === 2) {
            // 2 people: couple rooms or 2 collective spots
            suggestions.push(
                this.rooms.find(r => r.id === 'suite-casal-standard'),
                this.rooms.find(r => r.id === 'suite-casal-master')
            );
            // Only suggest collective if no children
            if (!includeChildren) {
                suggestions.push({
                    ...this.rooms.find(r => r.id === 'suite-coletiva'), 
                    id: 'suite-coletiva-2', 
                    name: '2x Leitos na su√≠te coletiva - Separado por sexo (com ar condicionado e sem TV)', 
                    available: Math.floor(this.rooms.find(r => r.id === 'suite-coletiva').available / 2)
                });
            }
        } else if (totalForRoomSelection === 3) {
            // 3 people: triple room (no collective if children)
            suggestions.push(this.rooms.find(r => r.id === 'suite-tripla-master'));
            if (!includeChildren) {
                suggestions.push({
                    ...this.rooms.find(r => r.id === 'suite-coletiva'), 
                    id: 'suite-coletiva-3', 
                    name: '3x Leitos na su√≠te coletiva - Separado por sexo (com ar condicionado e sem TV)', 
                    available: Math.floor(this.rooms.find(r => r.id === 'suite-coletiva').available / 3)
                });
            }
        } else if (totalForRoomSelection === 4) {
            // 4 people: quadruple rooms (no collective if children)
            suggestions.push(
                this.rooms.find(r => r.id === 'suite-quadrupla-standard'),
                this.rooms.find(r => r.id === 'suite-quadrupla-master')
            );
            if (!includeChildren) {
                suggestions.push({
                    ...this.rooms.find(r => r.id === 'suite-coletiva'), 
                    id: 'suite-coletiva-4', 
                    name: '4x Leitos na su√≠te coletiva - Separado por sexo (com ar condicionado e sem TV)', 
                    available: Math.floor(this.rooms.find(r => r.id === 'suite-coletiva').available / 4)
                });
            }
        } else if (totalForRoomSelection === 5 || totalForRoomSelection === 6) {
            // 5-6 people: sextuple room
            suggestions.push(this.rooms.find(r => r.id === 'suite-sextupla-master'));
        }
        
        return suggestions.filter(s => s && s.available > 0);
    }
    
    getRoomCombinations(totalPeople) {
        const combinations = [];
        
        // Try different combinations for more than 6 people
        if (totalPeople <= 8) {
            combinations.push({
                id: 'combo-casal-sextupla',
                name: 'Su√≠te casal master + Su√≠te s√™xtupla master',
                available: Math.min(
                    this.rooms.find(r => r.id === 'suite-casal-master').available,
                    this.rooms.find(r => r.id === 'suite-sextupla-master').available
                )
            });
        }
        
        if (totalPeople <= 10) {
            combinations.push({
                id: 'combo-quadrupla-sextupla',
                name: 'Su√≠te qu√°drupla master + Su√≠te s√™xtupla master',
                available: Math.min(
                    this.rooms.find(r => r.id === 'suite-quadrupla-master').available,
                    this.rooms.find(r => r.id === 'suite-sextupla-master').available
                )
            });
        }
        
        return combinations;
    }
    
    updateTotal() {
        const nights = this.calculateNights();
        const dailyRate = parseFloat(document.getElementById('dailyRate').value) || 0;
        let total = nights * dailyRate;
        
        // Add extra bed costs
        if (document.getElementById('includeExtraBed').checked) {
            const extraBedQuantity = parseInt(document.getElementById('extraBedQuantity').value) || 0;
            const extraBedPrice = parseFloat(document.getElementById('extraBedPrice').value) || 0;
            total += extraBedQuantity * extraBedPrice * nights;
        }
        
        // Add early check-in cost
        if (document.getElementById('earlyCheckin').checked) {
            const earlyPrice = parseFloat(document.getElementById('earlyPrice').value) || 0;
            total += earlyPrice;
        }
        
        // Add late check-out cost
        if (document.getElementById('lateCheckout').checked) {
            const latePrice = parseFloat(document.getElementById('latePrice').value) || 0;
            total += latePrice;
        }
        
        return total;
    }
    
    formatDate(dateString) {
        if (!dateString) return '00/00';
        const date = new Date(dateString);
        const day = date.getDate().toString().padStart(2, '0');
        const month = (date.getMonth() + 1).toString().padStart(2, '0');
        return `${day}/${month}`;
    }
    
    generateBudget() {
        // Validate required fields
        const requiredFields = ['checkin', 'checkout', 'adults', 'dailyRate', 'selectedRoom'];
        const missingFields = requiredFields.filter(field => !document.getElementById(field).value);
        
        if (missingFields.length > 0) {
            alert('Por favor, preencha todos os campos obrigat√≥rios.');
            return;
        }
        
        const nights = this.calculateNights();
        if (nights <= 0) {
            alert('A data de sa√≠da deve ser posterior √† data de entrada.');
            return;
        }
        
        // Get form data
        const data = this.getFormData();
        
        // Generate markdown
        const markdown = this.buildMarkdown(data);
        
        // Display result
        document.getElementById('markdownOutput').textContent = markdown;
        document.getElementById('resultSection').classList.add('show');
        
        // Scroll to result
        document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
    }
    
    getFormData() {
        const form = document.getElementById('budgetForm');
        const formData = new FormData(form);
        
        const data = {
            checkin: formData.get('checkin'),
            checkout: formData.get('checkout'),
            adults: parseInt(formData.get('adults')) || 0,
            dailyRate: parseFloat(formData.get('dailyRate')) || 0,
            selectedRoom: formData.get('selectedRoom'),
            includeChildren: document.getElementById('includeChildren').checked,
            children: parseInt(formData.get('children')) || 0,
            includeExtraBed: document.getElementById('includeExtraBed').checked,
            extraBedQuantity: parseInt(formData.get('extraBedQuantity')) || 0,
            extraBedPrice: parseFloat(formData.get('extraBedPrice')) || 0,
            isAverageRate: document.getElementById('isAverageRate').checked,
            earlyCheckin: document.getElementById('earlyCheckin').checked,
            earlyHour: formData.get('earlyHour'),
            earlyPrice: parseFloat(formData.get('earlyPrice')) || 0,
            lateCheckout: document.getElementById('lateCheckout').checked,
            lateHour: formData.get('lateHour'),
            latePrice: parseFloat(formData.get('latePrice')) || 0
        };
        
        data.nights = this.calculateNights();
        // Calculate total price including extras
        data.totalPrice = this.updateTotal();
        data.totalPeople = data.adults + (data.includeChildren ? data.children : 0);
        
        // Get room name - handle combinations
        if (data.selectedRoom.startsWith('combo-')) {
            const combo = this.getRoomCombinations(data.totalPeople).find(c => c.id === data.selectedRoom);
            data.roomName = combo ? combo.name : '';
        } else if (data.selectedRoom.startsWith('suite-coletiva-')) {
            const match = data.selectedRoom.match(/suite-coletiva-(\d+)/);
            if (match) {
                const count = match[1];
                data.roomName = `${count}x Leitos na su√≠te coletiva - Separado por sexo (com ar condicionado e sem TV)`;
            }
        } else {
            data.roomName = this.rooms.find(room => room.id === data.selectedRoom)?.name || '';
        }
        
        return data;
    }
    
    buildMarkdown(data) {
        let markdown = '*OR√áAMENTO:*\n';
        
        // Check-in line
        let checkinTime = '14h';
        if (data.earlyCheckin && data.earlyHour) {
            checkinTime = data.earlyHour.substring(0, 5);
        }
        markdown += `üóì  *Check-in:* ${this.formatDate(data.checkin)}, a partir das ${checkinTime}.\n`;
        
        // Check-out line
        let checkoutTime = '12h';
        if (data.lateCheckout && data.lateHour) {
            checkoutTime = data.lateHour.substring(0, 5);
        }
        markdown += `üóì  *Check-out:* ${this.formatDate(data.checkout)}, at√© √†s ${checkoutTime}.\n`;
        
        // Period line
        const nightText = data.nights === 1 ? 'di√°ria' : 'di√°rias';
        markdown += `‚è≥ *Per√≠odo:* ${data.nights} ${nightText}.\n\n`;
        
        // Room line
        markdown += `üè° *${data.roomName}*\n`;
        
        // Capacity line
        let capacityText = `${data.adults} pessoas`;
        if (data.includeChildren && data.children > 0) {
            const childText = data.children === 1 ? 'crian√ßa cortesia' : 'crian√ßas cortesia';
            capacityText += ` e ${data.children} ${childText}`;
        }
        if (data.includeExtraBed && data.extraBedQuantity > 0) {
            const bedText = data.extraBedQuantity === 1 ? 'colch√£o extra' : 'colch√µes extras';
            capacityText += `, incluso ${data.extraBedQuantity} ${bedText}`;
        }
        markdown += `üë• *Capacidade:* ${capacityText}.\n`;
        
        // Daily rate line
        let dailyRateText = `R$ ${data.dailyRate.toFixed(2).replace('.', ',')}`;
        if (data.isAverageRate) {
            dailyRateText += ' em m√©dia';
        }
        markdown += `üí∞ *Di√°ria:* ${dailyRateText}`;
        
        // Add early/late fees if applicable
        if (data.earlyCheckin && data.earlyPrice > 0) {
            markdown += `\nüïñ *Taxa early check-in:* R$ ${data.earlyPrice.toFixed(2).replace('.', ',')}`;
        }
        if (data.lateCheckout && data.latePrice > 0) {
            markdown += `\nüïï *Taxa late check-out:* R$ ${data.latePrice.toFixed(2).replace('.', ',')}`;
        }
        markdown += '\n';
        
        // Total line
        const nightTotalText = data.nights === 1 ? 'noite' : 'noites';
        let totalPeopleText = `${data.adults} pessoas`;
        if (data.includeChildren && data.children > 0) {
            const childText = data.children === 1 ? 'crian√ßa cortesia' : 'crian√ßas cortesia';
            totalPeopleText += ` e ${data.children} ${childText}`;
        }
        markdown += `üíµ *Total:* ${data.nights} ${nightTotalText}, R$ ${data.totalPrice.toFixed(2).replace('.', ',')} para ${totalPeopleText}.\n\n`;
        
        // Payment and additional info
        markdown += 'üí≥ *Formas de pagamento:* Sinal de 50% no ato da reserva e o restante na chegada.\n\n';
        markdown += '‚òï Caf√© da manh√£ incluso.\n';
        markdown += '‚ö†Ô∏è *Or√ßamento v√°lido por 24h.*';
        
        return markdown;
    }
    
    async copyToClipboard() {
        const markdownText = document.getElementById('markdownOutput').textContent;
        
        try {
            await navigator.clipboard.writeText(markdownText);
            const successMsg = document.getElementById('copySuccess');
            successMsg.classList.add('show');
            setTimeout(() => successMsg.classList.remove('show'), 3000);
        } catch (err) {
            // Fallback for older browsers
            const textArea = document.createElement('textarea');
            textArea.value = markdownText;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            
            const successMsg = document.getElementById('copySuccess');
            successMsg.classList.add('show');
            setTimeout(() => successMsg.classList.remove('show'), 3000);
        }
    }
    
    clearForm() {
        if (confirm('Tem certeza que deseja limpar todos os campos?')) {
            document.getElementById('budgetForm').reset();
            document.getElementById('resultSection').classList.remove('show');
            
            // Reset conditional fields
            document.querySelectorAll('.conditional-field').forEach(field => {
                field.classList.remove('active');
            });
            
            // Reset dates
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            document.getElementById('checkin').valueAsDate = today;
            document.getElementById('checkout').valueAsDate = tomorrow;
            document.getElementById('adults').value = '2';
            
            this.updateRoomOptions();
        }
    }
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    new BudgetGenerator();
});

// Dark mode support
if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    document.documentElement.classList.add('dark');
}
window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
    if (event.matches) {
        document.documentElement.classList.add('dark');
    } else {
        document.documentElement.classList.remove('dark');
    }
});
</script>
</body>
</html>
